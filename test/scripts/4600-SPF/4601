# lookup string-expansion
#
exim -bd -DSERVER=server -oX PORT_D:PORT_S
****
client 127.0.0.1 PORT_D
??? 220
helo testclient
??? 250
mail from:<a@example.com>
??? 250
rcpt to:<fred@test.ex>
??? 250
quit
****
client 127.0.0.1 PORT_S
??? 220
helo testclient
??? 250
mail from:<b@example.com>
??? 250
rcpt to:<fred@test.ex>
??? 250
quit
****
#
killdaemon
#
# SERVFAIL -> temperror
# A multiple spf-RR return should get permerror
# - and not crash with non-spf txt records
# v=spf1 is casr-insensitive
exim -be
temperror ${lookup {fred@test.again.dns} spf {HOSTIPV4}}
permerror ${lookup {fred@double.example.com} spf {8.8.8.8}}
permerror ${lookup {fred@doubleplus.example.com} spf {8.8.8.8}}
pass      ${lookup {fred@uppercase.example.com} spf {HOSTIPV4}}
****
